# Render.com Blueprint for JobAutoFlow
# FREE plan compatible

services:
  # Backend API Service
  - type: web
    name: jobautoflow-api
    runtime: node
    plan: free
    region: oregon

    buildCommand: |
      cd backend &&
      npm install &&
      npx prisma generate &&
      npm run build

    startCommand: |
      cd backend &&
      npx prisma migrate deploy &&
      npm start

    healthCheckPath: /health

    envVars:
      - key: NODE_ENV
        value: production

      - key: PORT
        value: 10000

      # Database (Supabase)
      - key: DATABASE_URL
        sync: false

      # Redis (Upstash)
      - key: REDIS_HOST
        sync: false

      - key: REDIS_PORT
        value: 6379

      - key: REDIS_PASSWORD
        sync: false

      # JWT Secrets (set manually in dashboard)
      - key: JWT_SECRET
        sync: false

      - key: JWT_REFRESH_SECRET
        sync: false

      - key: JWT_ACCESS_EXPIRATION
        value: 15m

      - key: JWT_REFRESH_EXPIRATION
        value: 7d

      # Stripe (optional)
      - key: STRIPE_SECRET_KEY
        sync: false

      - key: STRIPE_WEBHOOK_SECRET
        sync: false

      # Email
      - key: SENDGRID_API_KEY
        sync: false

      - key: EMAIL_FROM
        value: noreply@jobautoflow.com

      - key: EMAIL_FROM_NAME
        value: JobAutoFlow

      # OpenAI
      - key: OPENAI_API_KEY
        sync: false

      - key: OPENAI_MODEL
        value: gpt-3.5-turbo

      # Frontend URL (update after Vercel deployment)
      - key: FRONTEND_URL
        sync: false

    autoDeploy: true

